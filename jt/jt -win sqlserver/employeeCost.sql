select a.name 姓名,操作时间,preparetime 调机时间 ,cast(wage as decimal(18,2)) "工资/分",wages+工资 工资,产值,报废数量, 报废成本 from (select b.wage,b.name,a.employee,sum(a.worktime) 操作时间,sum(a.worktime)*wage 工资,sum(a.worktime*c.cost) 产值,sum(a.scrapnum) 报废数量,SUM(e.reportprice*a.scrapnum) 报废成本 from employee b left join operationwork  a on a.employee=b.id  join operationplan c on a.operationplan = c.id join plan d on c.plan=d.id join bill e on d.bill =e.id  where b.name like '%%' and finishdate between '2010-1-1' and '2014-1-1' group by a.employee ) a   join (select a.id employee,a.name, ifnull(sum(preparetime),0) preparetime,ifnull(sum(preparetime),0)*wage wages from employee a  left join operationwork b on b.prepareemployee =a.id and finishdate between '2010-1-1' and '2014-1-1'  group by a.id) as b on b.employee=a.employee
